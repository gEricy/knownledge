### 1. 一致性篇

#### 2PC

用来保证分布式事务的原子性（原子性满足，就一定会满足一致性）

#### paxos协议

用于解决多个节点的一致性问题

提议者/接收者

- 执行步骤
  1. 批准：提议者发送消息到接收者，要求这首某个提议
  2. 确认： 如果超过一半的接收者同意，意味着提议生效（提议者会发送ACK，通知所有的接收者，该提议生效）



### 2. 高可靠

数据可靠不丢失

- 单机
  1. RAID（磁盘阵列） 镜像/条带化
  2. 日志记录

### 3. 高可用

冗余：Rep-sets副本集、主从复本

### 4. 高性能

IOPS/吞吐/时延



### 5. 负载均衡

CPU利用率、内存使用率、网络流量权值

### 6. 架构

- 元数据服务器

  请求侦听

  元数据管理（元数据/数据分离解耦）

  文件、文件块管理

  客户端租约

  心跳检查

- 客户端

- chunkServer保存数据

### 7. 监控

进程、语义、错误日志、coredump、机器资源



---

- 元数据/数据分离解耦

  > 左子树
  >
  > 右子树

- 容灾

  - 多副本

    > 主从复制
    >
    > 一致性保障：quorum（副本/仲裁）

  - 异地多活

  - 小特性：发生故障时的处理（数据迁移 / 数据重建）

- 高可用

  - Zookeeper集群分布式管理

- 高性能

  - shard + 条带化（同一时间多条带并发写）
  - 读写缓存
  - 流水线（pipeline）: 车间流水线（分层思想）

- 成本优化

  - 模式删除/压缩重删与logstore
  - 纠删码